import { useRef, useState } from 'react';import { BlockMath } from 'react-katex';function TrialDivision() {    const [input, setInput] = useState('');    const [visibleSteps, setVisibleSteps] = useState<string[]>([]);    const [factorMap, setFactorMap] = useState<Map<number, number>>(new Map());    const [animating, setAnimating] = useState(false);    const scrollRef = useRef<HTMLDivElement>(null);    const startAnimation = (steps: string[]) => {        let i = 0;        setVisibleSteps([]);        setAnimating(true);        const interval = setInterval(() => {            setVisibleSteps((prev) => [...prev, steps[i-1]]);            scrollRef.current?.scrollTo(0, scrollRef.current.scrollHeight);            i++;            if (i >= steps.length) {                clearInterval(interval);                setAnimating(false);            }        }, 400);    };    const factorize = (n: number) => {        const steps: string[] = [];        const map = new Map<number, number>();        let num = n;        let d = 2;        while (d * d <= num) {            if (num % d === 0) {                steps.push(`\\color{white} { \\text{Try } ${d} \\rightarrow ${num} \\bmod ${d} = 0 \\Rightarrow \\text{Factor found: } ${d} }`);                num = Math.floor(num / d);                map.set(d, (map.get(d) || 0) + 1);            } else {                steps.push(`\\color{white} { \\text{Try } ${d} \\rightarrow ${num} \\bmod ${d} \\ne 0 }`);                d++;            }        }        // Final check for remaining prime number        if (num > 1) {            steps.push(`\\color{white} { \\text{Try } ${num} \\rightarrow \\text{No divisors left, } ${num} \\text{ is prime} \\Rightarrow \\text{Stop} }`);            map.set(num, (map.get(num) || 0) + 1);        }        setFactorMap(map);        startAnimation(steps);    };    // Format factors like: 2 \times 5^2    const formatFactorProduct = () => {        if (factorMap.size === 0) return '';        const parts: string[] = [];        factorMap.forEach((count, prime) => {            parts.push(count === 1 ? `\\color{white} { ${prime} }` : `\\color{white} { ${prime}^{${count}} }`);        });        return parts.join(' \\times ');    };    return (        <div className="pt-[10px] text-gray-800 font-mono">            <div className="flex flex-col items-center max-w-2xl mx-auto bg-white shadow-xl rounded-lg">                <h1 className="text-[28px] font-bold mb-[15px] text-center" style={{color: 'white'}}>                    Trial Division                </h1>                <form className="flex w-[400px] h-[45px] gap-[8px] mb-[10px]">                    <input                        type="number"                        className="outline-none border border-gray-300 rounded px-[12px] py-[8px] text-[22px] w-full sm:w-auto"                        placeholder="Enter a number"                        value={input}                        onChange={(e) => setInput(e.target.value)}                    />                    <button                        onClick={() => factorize(Number(input))}                        className="cursor-pointer bg-purple-600 hover:bg-purple-700 text-white px-[20px] py-[8px] rounded transition"                        disabled={animating}                    >                        {animating ? 'Running...' : 'Factorize'}                    </button>                </form>                {/* üîÅ Step-by-step LaTeX */}                <div                    ref={scrollRef}                    className="bg-slate-50 overflow-y-auto scroll-auto max-h-[72vh] space-y-[5px] text-[18px]"                >                    {visibleSteps.map((latex, idx) => (                        <div key={idx} className="text-lg transition-opacity duration-500 ease-in">                            <BlockMath>{latex}</BlockMath>                        </div>                    ))}                </div>                {/* üßÆ Final Factor Result */}                {factorMap.size > 0 && !animating && (                    <div className="text-center">                        <p className="text-[18px]" style={{color: 'white'}}>‚úÖ ‘≥’ø’°’∂÷Ñ ’∫’°÷Ä’¶ ’°÷Ä’ø’°’§÷Ä’´’π’∂’•÷Ä:</p>                        <BlockMath>{formatFactorProduct()}</BlockMath>                    </div>                )}            </div>        </div>    );}export default TrialDivision;